<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALPR Search - Advanced Vehicle Search & Tracking</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated background */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a0a 100%);
        }

        .floating-orbs {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            animation: float 20s infinite ease-in-out;
        }

        .orb1 {
            width: 300px;
            height: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            top: -150px;
            left: -150px;
            animation-delay: 0s;
        }

        .orb2 {
            width: 400px;
            height: 400px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            bottom: -200px;
            right: -200px;
            animation-delay: 5s;
        }

        .orb3 {
            width: 250px;
            height: 250px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            33% {
                transform: translate(30px, -30px) rotate(120deg);
            }
            66% {
                transform: translate(-20px, 20px) rotate(240deg);
            }
        }

        /* Navigation */
        nav {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s ease;
            font-weight: 500;
        }

        .nav-links a:hover {
            color: #ffffff;
        }

        /* Main container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            padding-top: 2rem;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.6);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Search section */
        .search-section {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .search-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .search-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            font-size: 1.125rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .search-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        /* Filters */
        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 600;
        }

        .filter-select,
        .filter-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .filter-select:focus,
        .filter-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .filter-select option {
            background: #1a1a2e;
        }

        /* Quick stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.1);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .stat-card.suspicious { --gradient-start: #f5576c; --gradient-end: #f093fb; }
        .stat-card.frequent { --gradient-start: #4facfe; --gradient-end: #00f2fe; }
        .stat-card.recent { --gradient-start: #fa709a; --gradient-end: #fee140; }
        .stat-card.anomalies { --gradient-start: #30cfd0; --gradient-end: #330867; }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.875rem;
        }

        /* Results section */
        .results-section {
            display: none;
            margin-bottom: 3rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .results-header h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #ffffff;
        }

        .results-info {
            color: rgba(255, 255, 255, 0.6);
        }

        .results-grid {
            display: grid;
            gap: 1.5rem;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .result-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.1);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-plate {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            color: #ffffff;
        }

        .result-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.875rem;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .result-detail {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .detail-label {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .detail-value {
            font-size: 1rem;
            color: #ffffff;
            font-weight: 600;
        }

        .result-alerts {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .alert-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(245, 87, 108, 0.2);
            color: #f5576c;
        }

        /* Journey view */
        .journey-timeline {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timeline-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            position: relative;
            padding-left: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0.5rem;
            width: 8px;
            height: 8px;
            background: #4facfe;
            border-radius: 50%;
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: 0.75rem;
            top: 1rem;
            width: 2px;
            height: calc(100% + 0.5rem);
            background: rgba(255, 255, 255, 0.1);
        }

        .timeline-item:last-child::after {
            display: none;
        }

        .timeline-time {
            min-width: 100px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.875rem;
        }

        .timeline-location {
            color: #ffffff;
            font-weight: 600;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .empty-state img {
            width: 200px;
            opacity: 0.3;
            margin-bottom: 1rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            .filters {
                grid-template-columns: 1fr;
            }
            
            .quick-stats {
                grid-template-columns: 1fr;
            }
            
            .result-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="background">
        <div class="floating-orbs">
            <div class="orb orb1"></div>
            <div class="orb orb2"></div>
            <div class="orb orb3"></div>
        </div>
    </div>

    <nav>
        <div class="nav-container">
            <a href="/ui/navigation.html" class="logo">ALPR System</a>
            <ul class="nav-links">
                <li><a href="/ui/navigation.html">Home</a></li>
                <li><a href="/ui/">Upload</a></li>
                <li><a href="/ui/analytics.html">Analytics</a></li>
                <li><a href="/ui/surveillance.html">Surveillance</a></li>
                <li><a href="/ui/search.html">Search</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1>Vehicle Search & Tracking</h1>
            <p>Search through detection history and track vehicle movements across cameras</p>
        </div>

        <div class="search-section">
            <div class="search-bar">
                <input type="text" class="search-input" id="search-input" 
                       placeholder="Enter license plate number (e.g., ABC1234)">
                <button class="search-btn" onclick="searchVehicles()">
                    <span>üîç</span> Search
                </button>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label">Time Range</label>
                    <select class="filter-select" id="time-range">
                        <option value="1h">Last Hour</option>
                        <option value="24h" selected>Last 24 Hours</option>
                        <option value="7d">Last 7 Days</option>
                        <option value="30d">Last 30 Days</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Vehicle Type</label>
                    <select class="filter-select" id="vehicle-type">
                        <option value="">All Types</option>
                        <option value="Sedan">Sedan</option>
                        <option value="SUV">SUV</option>
                        <option value="Truck">Truck</option>
                        <option value="Van">Van</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Alert Type</label>
                    <select class="filter-select" id="alert-type">
                        <option value="">All Vehicles</option>
                        <option value="NO_PLATE">No Plate</option>
                        <option value="PLATE_SWITCH">Plate Switch</option>
                        <option value="LOITERING">Loitering</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Camera</label>
                    <select class="filter-select" id="camera-filter">
                        <option value="">All Cameras</option>
                        <option value="cam_01">Main Entrance</option>
                        <option value="cam_02">Parking Lot A</option>
                        <option value="cam_03">East Gate</option>
                        <option value="cam_04">West Exit</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="quick-stats">
            <div class="stat-card suspicious" onclick="loadSuspiciousVehicles()">
                <div class="stat-icon">‚ö†Ô∏è</div>
                <div class="stat-value" id="suspicious-count">0</div>
                <div class="stat-label">Suspicious Vehicles</div>
            </div>

            <div class="stat-card frequent" onclick="loadFrequentVehicles()">
                <div class="stat-icon">üìä</div>
                <div class="stat-value" id="frequent-count">0</div>
                <div class="stat-label">Frequent Visitors</div>
            </div>

            <div class="stat-card recent" onclick="loadRecentDetections()">
                <div class="stat-icon">üïê</div>
                <div class="stat-value" id="recent-count">0</div>
                <div class="stat-label">Recent Detections</div>
            </div>

            <div class="stat-card anomalies" onclick="loadAnomalies()">
                <div class="stat-icon">üö®</div>
                <div class="stat-value" id="anomaly-count">0</div>
                <div class="stat-label">Active Anomalies</div>
            </div>
        </div>

        <div class="results-section" id="results-section">
            <div class="results-header">
                <h2>Search Results</h2>
                <span class="results-info" id="results-info"></span>
            </div>
            <div class="results-grid" id="results-grid">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Load initial statistics
        async function loadStats() {
            try {
                // Load anomalies count
                const anomaliesResponse = await fetch('/api/v1/anomalies/all?time_window_hours=24');
                const anomaliesData = await anomaliesResponse.json();
                document.getElementById('anomaly-count').textContent = anomaliesData.anomalies.length;

                // Load frequent vehicles
                const frequentResponse = await fetch('/api/v1/search/frequent-vehicles?time_window_hours=24&min_appearances=5');
                const frequentData = await frequentResponse.json();
                document.getElementById('frequent-count').textContent = frequentData.total_found;

                // Get suspicious detections (anomaly alerts)
                try {
                    const suspiciousResponse = await fetch('/api/v1/detections/anomalies');
                    const suspiciousData = await suspiciousResponse.json();
                    document.getElementById('suspicious-count').textContent = 
                        suspiciousData.anomalies ? suspiciousData.anomalies.length : '0';
                } catch (error) {
                    console.warn('Could not fetch suspicious detections:', error);
                    document.getElementById('suspicious-count').textContent = '0';
                }

                // Get recent detections count
                try {
                    const recentResponse = await fetch('/api/v1/detections/stats');
                    const recentData = await recentResponse.json();
                    document.getElementById('recent-count').textContent = 
                        recentData.total_detections || '0';
                } catch (error) {
                    console.warn('Could not fetch recent detections:', error);
                    document.getElementById('recent-count').textContent = '0';
                }

            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function searchVehicles() {
            const searchInput = document.getElementById('search-input').value.trim();
            const timeRange = document.getElementById('time-range').value;
            const vehicleType = document.getElementById('vehicle-type').value;
            const alertType = document.getElementById('alert-type').value;
            const camera = document.getElementById('camera-filter').value;

            const resultsSection = document.getElementById('results-section');
            const resultsGrid = document.getElementById('results-grid');
            const resultsInfo = document.getElementById('results-info');

            // Show loading state
            resultsSection.style.display = 'block';
            resultsGrid.innerHTML = '<div class="empty-state"><div class="loading"></div><p>Searching...</p></div>';

            try {
                const params = new URLSearchParams();
                if (searchInput) params.append('plate', searchInput);
                params.append('timeRange', timeRange);
                if (vehicleType) params.append('vehicleTypes', vehicleType);
                if (alertType) params.append('alerts', alertType);
                if (camera) params.append('cameras', camera);

                const response = await fetch(`/api/v1/search/vehicles?${params}`);
                const data = await response.json();

                if (data.results && data.results.length > 0) {
                    resultsInfo.textContent = `Found ${data.total} results`;
                    displayResults(data.results);
                } else {
                    resultsGrid.innerHTML = `
                        <div class="empty-state">
                            <p>No vehicles found matching your criteria</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem;">Try adjusting your search filters</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error searching vehicles:', error);
                resultsGrid.innerHTML = '<div class="empty-state"><p>Error performing search</p></div>';
            }
        }

        function displayResults(results) {
            const resultsGrid = document.getElementById('results-grid');
            
            resultsGrid.innerHTML = results.map(result => {
                const alertBadges = result.alerts && result.alerts.length > 0 ? 
                    result.alerts.map(alert => 
                        `<span class="alert-badge">${alert.type}</span>`
                    ).join('') : '';

                return `
                    <div class="result-card" onclick="showVehicleJourney('${result.plate_text}')">
                        <div class="result-header">
                            <div class="result-plate">${result.plate_text}</div>
                            <div class="result-time">${formatTime(result.timestamp)}</div>
                        </div>
                        <div class="result-details">
                            <div class="result-detail">
                                <span class="detail-label">Vehicle</span>
                                <span class="detail-value">${formatVehicleInfo(result.vehicle)}</span>
                            </div>
                            <div class="result-detail">
                                <span class="detail-label">State</span>
                                <span class="detail-value">${result.state || 'Unknown'}</span>
                            </div>
                            <div class="result-detail">
                                <span class="detail-label">Camera</span>
                                <span class="detail-value">${getCameraName(result.camera_id)}</span>
                            </div>
                            <div class="result-detail">
                                <span class="detail-label">Confidence</span>
                                <span class="detail-value">${Math.round(result.confidence * 100)}%</span>
                            </div>
                        </div>
                        ${alertBadges ? `<div class="result-alerts">${alertBadges}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        async function showVehicleJourney(plateText) {
            // Fetch and display vehicle journey
            try {
                const response = await fetch(`/api/v1/search/journey/${plateText}`);
                const journey = await response.json();
                
                // Display journey timeline (you can expand this to show in a modal)
                console.log('Vehicle journey:', journey);
                
                // For now, just alert with basic info
                alert(`Vehicle ${plateText} has been seen ${journey.timeline.length} times across ${journey.journey_stats.cameras_visited} cameras`);
                
            } catch (error) {
                console.error('Error loading journey:', error);
            }
        }

        async function loadSuspiciousVehicles() {
            const params = new URLSearchParams({ alerts: 'PLATE_SWITCH,NO_PLATE' });
            document.getElementById('alert-type').value = 'PLATE_SWITCH';
            await searchVehicles();
        }

        async function loadFrequentVehicles() {
            try {
                const response = await fetch('/api/v1/search/frequent-vehicles?time_window_hours=24&min_appearances=5');
                const data = await response.json();
                
                const resultsSection = document.getElementById('results-section');
                const resultsGrid = document.getElementById('results-grid');
                const resultsInfo = document.getElementById('results-info');
                
                resultsSection.style.display = 'block';
                resultsInfo.textContent = `${data.total_found} frequent vehicles`;
                
                if (data.frequent_vehicles && data.frequent_vehicles.length > 0) {
                    resultsGrid.innerHTML = data.frequent_vehicles.map(vehicle => `
                        <div class="result-card">
                            <div class="result-header">
                                <div class="result-plate">${vehicle.plate_text}</div>
                                <div class="result-time">${vehicle.appearance_count} appearances</div>
                            </div>
                            <div class="result-details">
                                <div class="result-detail">
                                    <span class="detail-label">First Seen</span>
                                    <span class="detail-value">${formatTime(vehicle.first_seen)}</span>
                                </div>
                                <div class="result-detail">
                                    <span class="detail-label">Last Seen</span>
                                    <span class="detail-value">${formatTime(vehicle.last_seen)}</span>
                                </div>
                                <div class="result-detail">
                                    <span class="detail-label">Frequency</span>
                                    <span class="detail-value">${vehicle.frequency_per_hour.toFixed(1)}/hour</span>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
                
            } catch (error) {
                console.error('Error loading frequent vehicles:', error);
            }
        }

        async function loadRecentDetections() {
            document.getElementById('time-range').value = '1h';
            await searchVehicles();
        }

        async function loadAnomalies() {
            try {
                const response = await fetch('/api/v1/anomalies/all?time_window_hours=24');
                const data = await response.json();
                
                const resultsSection = document.getElementById('results-section');
                const resultsGrid = document.getElementById('results-grid');
                const resultsInfo = document.getElementById('results-info');
                
                resultsSection.style.display = 'block';
                resultsInfo.textContent = `${data.anomalies.length} anomalies detected`;
                
                if (data.anomalies && data.anomalies.length > 0) {
                    resultsGrid.innerHTML = data.anomalies.map(anomaly => `
                        <div class="result-card">
                            <div class="result-header">
                                <div class="result-plate">${anomaly.plate_text || 'NO PLATE'}</div>
                                <div class="result-time">${formatTime(anomaly.detected_time)}</div>
                            </div>
                            <div class="result-details">
                                <div class="result-detail">
                                    <span class="detail-label">Type</span>
                                    <span class="detail-value">${anomaly.type}</span>
                                </div>
                                <div class="result-detail">
                                    <span class="detail-label">Severity</span>
                                    <span class="detail-value">${anomaly.severity}</span>
                                </div>
                            </div>
                            <div style="margin-top: 1rem; color: rgba(255, 255, 255, 0.7);">
                                ${anomaly.message}
                            </div>
                        </div>
                    `).join('');
                }
                
            } catch (error) {
                console.error('Error loading anomalies:', error);
            }
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            const hours = Math.floor(diff / 3600000);
            const minutes = Math.floor((diff % 3600000) / 60000);
            
            if (hours > 24) {
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            } else if (hours > 0) {
                return `${hours}h ago`;
            } else if (minutes > 0) {
                return `${minutes}m ago`;
            } else {
                return 'Just now';
            }
        }

        function formatVehicleInfo(vehicle) {
            const parts = [];
            if (vehicle.color) parts.push(vehicle.color);
            if (vehicle.make) parts.push(vehicle.make);
            if (vehicle.model) parts.push(vehicle.model);
            if (vehicle.type && parts.length === 0) parts.push(vehicle.type);
            
            return parts.join(' ') || 'Unknown';
        }

        function getCameraName(cameraId) {
            const cameraNames = {
                'cam_01': 'Main Entrance',
                'cam_02': 'Parking Lot A',
                'cam_03': 'East Gate',
                'cam_04': 'West Exit'
            };
            return cameraNames[cameraId] || cameraId || 'Unknown';
        }

        // Search on Enter key
        document.getElementById('search-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchVehicles();
            }
        });

        // Initialize page
        loadStats();
    </script>
</body>
</html>